import e,{memo as o,useState as l,useMemo as t,useEffect as a,useLayoutEffect as r}from"react";import{useAtom as n,atom as s,createStore as i,Provider as d}from"jotai";function c(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return e?e.filter((function(e){return!!e})).join(" "):""}var u=function(){return u=Object.assign||function(e){for(var o,l=1,t=arguments.length;l<t;l++)for(var a in o=arguments[l])Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);return e},u.apply(this,arguments)};function v(e,o,l){if(l||2===arguments.length)for(var t,a=0,r=o.length;a<r;a++)!t&&a in o||(t||(t=Array.prototype.slice.call(o,0,a)),t[a]=o[a]);return e.concat(t||Array.prototype.slice.call(o))}"function"==typeof SuppressedError&&SuppressedError;var m=20;function _(e){void 0===e&&(e=0);for(var o=[],l=1;l<arguments.length;l++)o[l-1]=arguments[l];return e<=m-1?o[e]?o[e]:_.apply(void 0,v([e+1],o,!1)):void 0}function h(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return _.apply(void 0,v([1],e,!1))}var b=o((function(o){var t=n(o.column)[0],a=n(o.row)[0],r=a[t.name],s=l(!1),i=s[0],d=s[1],c=l(r),u=c[0],v=c[1],m=o.atom.cell.onChange;return i?e.createElement("input",{type:"text",value:u,onChange:function(e){v(e.target.value)},onBlur:function(){m&&m({row:a,column:t},u),d(!1)}}):e.createElement("div",{onDoubleClick:function(){d(!0)}},r)}),(function(){return!0})),f=o((function(o){var l,t=n(o.row)[0],a=n(o.column)[0],r=n(o.atom.classes.cell.classes.root)[0],s=n(o.atom.classes.cell.overrideClasses.root)[0],i=t[a.name],d=o.atom.cell.onClick,u=o.atom.cell.onChange,v={value:i,row:t,column:a},m=a.render?a.render(v):i;return e.createElement("td",{style:{width:a.flex?"100% !important":null!==(l=a.width)&&void 0!==l?l:"fit-content",minWidth:a.width?a.width:a.minWidth,maxWidth:a.width?a.width:a.maxWidth},className:h(s,c(r,"am_table__body--cell am_table__body__cell--root")),onClick:function(){d&&d(v)}},a.editable&&u?e.createElement(b,{atom:o.atom,columnIndex:o.columnIndex,rowIndex:o.rowIndex,column:o.column,row:o.row}):m)}),(function(){return!0})),p=o((function(o){return e.createElement("div",{onClick:o.onChange,className:c("am_input--checkbox am_input__checkbox--root",o.checked?"am_input__checkbox--checked":"")},e.createElement("div",{className:"am_input__checkbox--check"},e.createElement("div",{className:"am_input__checkbox__check--inner"})))}),(function(e,o){return e.checked===o.checked})),C=o((function(o){var l=n(o.atom.columns)[0],a=n(o.atom.pagination.currentPage)[0],r=n(o.atom.pagination.itemsPerPage)[0];n(o.atom.row.indexing.label)[0];var i=n(o.atom.row.indexing.enabled)[0],d=n(o.atom.row.selection)[0],u=n(o.atom.row.editable)[0],v=n(o.atom.classes.row.classes.root)[0],m=n(o.atom.classes.row.overrideClasses.root)[0],_=n(o.atom.classes.cell.classes.root)[0],b=n(o.atom.classes.cell.overrideClasses.root)[0],C=t((function(){return u?o.row:s(o.row)}),[u]),w=n(C),g=w[0];w[1];var y=n(o.atom.idProperty)[0],E=n(o.atom.row.selected),k=E[0],x=E[1],P=g[y],N=d&&!!k[P],z=o.atom.row.onClick,W=r&&a&&[1,0].includes(a)?o.index+1+a*r:o.index+1,B=function(){if(d){var e=Object.assign({},k);N?delete e[P]:e[P]=o.row,x(e)}};return e.createElement("tr",{className:h(m,c(v,d?"am_table__body__row--selectable":void 0,N?"am_table__body__row--selected":void 0,"am_table__body--row am_table__body__row--root")),onClick:function(){z&&z(g),d&&B()}},d?e.createElement("td",{className:h(b,c(_,"am_table__body--cell am_table__body__cell--root am_table__body__cell--checkbox"))},e.createElement("div",{className:"am_table__body__cell__checkbox--root"},e.createElement(p,{checked:N,onChange:B,atom:o.atom}))):null,i?e.createElement("td",{className:h(b,c(_,"am_table__body--cell am_table__body__cell--root am_table__body__cell--row-number"))},e.createElement("div",{className:"am_table__body__cell__row-number--root"},W)):null,l.map((function(l,t){return e.createElement(f,{key:"body_row_cell_".concat(t),atom:o.atom,row:s(g),column:l,columnIndex:t,rowIndex:o.index})})))}),(function(){return!0})),w=o((function(o){var l=n(o.atom.data)[0],t=n(o.atom.pagination.currentPage)[0],a=n(o.atom.pagination.itemsPerPage)[0],r=n(o.atom.classes.body.classes.root)[0],s=n(o.atom.classes.body.overrideClasses.root)[0],i=a&&0!==a?l.slice(((null!=t?t:0)-1)*a,(null!=t?t:0)*a):l;return e.createElement("tbody",{className:h(s,c(r,"am_table__body am_table__body--root"))},i.map((function(l,t){return e.createElement(C,{key:"body_row_".concat(t),index:t,row:l,atom:o.atom})})))}),(function(){return!0}));function g(o){var l,t,a,r,n,s,i;return e.createElement("svg",{fill:null!==(l=o.color)&&void 0!==l?l:"none",width:null!==(t=o.width)&&void 0!==t?t:24,height:null!==(a=o.height)&&void 0!==a?a:24,viewBox:"0 0 ".concat(null!==(r=o.width)&&void 0!==r?r:24," ").concat(null!==(n=o.height)&&void 0!==n?n:24),strokeWidth:null!==(s=o.strokeWidth)&&void 0!==s?s:1,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:null!==(i=o.color)&&void 0!==i?i:"none"}),e.createElement("path",{d:"M12 5l0 14"}),e.createElement("path",{d:"M16 15l-4 4"}),e.createElement("path",{d:"M8 15l4 4"}))}function y(o){var l,t,a,r,n,s,i;return e.createElement("svg",{fill:null!==(l=o.color)&&void 0!==l?l:"none",width:null!==(t=o.width)&&void 0!==t?t:24,height:null!==(a=o.height)&&void 0!==a?a:24,viewBox:"0 0 ".concat(null!==(r=o.width)&&void 0!==r?r:24," ").concat(null!==(n=o.height)&&void 0!==n?n:24),strokeWidth:null!==(s=o.strokeWidth)&&void 0!==s?s:1,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:null!==(i=o.color)&&void 0!==i?i:"none"}),e.createElement("path",{d:"M12 5l0 14"}),e.createElement("path",{d:"M16 9l-4 -4"}),e.createElement("path",{d:"M8 9l4 -4"}))}function E(o){var l=n(o.atom.classes.headerCell.classes.resizeHandle.root)[0],t=n(o.atom.classes.headerCell.overrideClasses.resizeHandle.root)[0];return e.createElement("span",{onDrag:function(e){console.log(e)},className:h(t,c(l,"am_table__header__cell--resize-handle am_table__header__cell__resize-handle--root"))})}var k=o((function(o){var l,t=function(e){var o=n(e.atom.classes.headerCell.classes.root)[0],l=n(e.atom.classes.headerCell.overrideClasses.root)[0],t=n(e.atom.classes.headerCell.classes.content.root)[0],a=n(e.atom.classes.headerCell.overrideClasses.content.root)[0],r=n(e.atom.classes.headerCell.classes.sortBtn.root)[0],s=n(e.atom.classes.headerCell.overrideClasses.sortBtn.root)[0];return{classes:{root:o,content:t,sortBtn:r},overrideClasses:{root:l,content:a,sortBtn:s}}}(o),r=t.classes,s=t.overrideClasses,i=n(o.atom.data),d=i[0],v=i[1],m=n(o.column),_=m[0],b=m[1],f=n(o.atom.sort.defaultSortedColumn),p=f[0],C=f[1],w=n(o.atom.sort.defaultSortDirection),k=w[0],x=w[1],P=o.atom.header.cell.onClick;a((function(){var e,o;k&&p&&v((e=p,void 0===(o=k)&&(o="asc"),d.slice().sort((function(l,t){var a=l[e],r=t[e];return"asc"===o?a<r?-1:a>r?1:0:a>r?-1:a<r?1:0}))))}),[k,p]);return e.createElement("th",{style:{width:_.flex?"100% !important":null!==(l=_.width)&&void 0!==l?l:"fit-content",minWidth:_.width?_.width:_.minWidth,maxWidth:_.width?_.width:_.maxWidth},onClick:function(){p===_.name?x("asc"===k?"desc":"asc"):(C(_.name),x("asc")),P&&P(_,b)},className:h(s.root,c(r.root,"am_table__header--cell am_table__header__cell--root"))},e.createElement("div",{className:h(s.content,c(r.content,"am_table__header__cell--content"))},e.createElement("span",null,_.header),p===_.name&&e.createElement("div",{className:h(s.sortBtn,c(r.sortBtn,"am_table__header__cell--sort-btn"))},e.createElement("span",{className:"am_table__header__cell__sort-btn--arrows"},"asc"===k?e.createElement(g,{width:18,height:20}):e.createElement(y,{width:18,height:20})))),_.filterable?e.createElement(e.Fragment,null):null,e.createElement(E,u({},o)))}),(function(){return!0}));var x=o((function(o){var l,t=n(o.atom.data)[0],a=n(o.atom.idProperty)[0],r=n(o.atom.row.indexing.label)[0],s=n(o.atom.row.indexing.enabled)[0],i=n(o.atom.classes.header.classes.root)[0],d=n(o.atom.classes.header.overrideClasses.root)[0],u=n(o.atom.classes.headerRow.classes.root)[0],v=n(o.atom.classes.headerRow.overrideClasses.root)[0],m=n(o.atom.classes.headerCell.classes.root)[0],_=n(o.atom.classes.headerCell.overrideClasses.root)[0],b=n(o.atom.row.selection)[0],f=n(o.atom.row.selected),C=f[0],w=f[1],g=(l=o.atom,{columns:n(l.columns)[0],selection:n(l.row.selection)[0]}).columns,y=Object.keys(C).length===t.length;return e.createElement("thead",{className:h(d,c(i,"am_table__header am_table__header--root"))},e.createElement("tr",{className:h(v,c(u,"am_table__header--row am_table__header__row--root"))},b?e.createElement("th",{className:h(_,c(m,"am_table__header--cell am_table__header__cell--root am_table__header__cell--checkbox"))},e.createElement("div",{className:"am_table__header__cell__checkbox--root"},e.createElement(p,{checked:y,onChange:function(){if(y)w({});else{var e=Object.assign({},C);t.forEach((function(o){return e[o[a]]=o})),w(e)}},atom:o.atom}))):null,s?e.createElement("th",{className:h(_,c(m,"am_table__header--cell am_table__header__cell--root am_table__header__cell--row-number"))},e.createElement("div",{className:"am_table__header__cell__row-number--root"},r)):null,g.map((function(l,t){return e.createElement(k,{key:"header_cell_".concat(t),column:l,atom:o.atom,index:t})}))))}),(function(){return!0})),P=o((function(o){var l=n(o.atom.data)[0],t=n(o.atom.pagination.currentPage)[0],a=n(o.atom.pagination.itemsPerPage)[0],r=a&&0!==a?Math.ceil(l.length/a):1,s=1===t,i=1===t;return e.createElement("div",{className:"am_container__pagination"},e.createElement("button",{disabled:s},"قبل"),e.createElement("span",null,"صفحه ",t," از ",r),e.createElement("button",{disabled:i},"بعد"))}),(function(){return!0})),N={color:"--am__table-color",hover:"--am__table-hover-color",focus:"--am__table-focus-color",selected:"--am__table-selected-color",resizeHandle:"--am__table-resize-handle-color"};function z(e,o){if(e.startsWith("#")){e=e.slice(1);var l=parseInt(e.slice(0,2),16),t=parseInt(e.slice(2,4),16),a=parseInt(e.slice(4,6),16);return"rgba(".concat(l,", ").concat(t,", ").concat(a,", ").concat(o,")")}if(e.startsWith("rgb(")){var r=e.match(/(\d+),\s*(\d+),\s*(\d+)\)/);if(r){l=parseInt(r[1],10),t=parseInt(r[2],10),a=parseInt(r[3],10);return"rgba(".concat(l,", ").concat(t,", ").concat(a,", ").concat(o,")")}return e}return e}function W(e){var o=e.atom,l=n(o.color)[0];r((function(){l&&function(e){document.body.style.setProperty(N.color,e),document.body.style.setProperty(N.hover,z(e,.15)),document.body.style.setProperty(N.selected,z(e,.4)),document.body.style.setProperty(N.focus,z(e,.3)),document.body.style.setProperty(N.resizeHandle,"white")}(l)}),[l])}var B=o((function(o){var l=o.atom,t=n(l.classes.table.classes.root)[0],a=n(l.classes.table.overrideClasses.root)[0],r=n(l.classes.container.classes.root)[0],s=n(l.classes.container.overrideClasses.root)[0],i=n(l.classes.wrapper.classes.root)[0],d=n(l.classes.wrapper.overrideClasses.root)[0],u=n(l.pagination.enabled)[0];return W({atom:l}),e.createElement("div",{className:h(s,c(r,"am_table__container"))},e.createElement("div",{className:h(d,c(i,"am_table__wrapper"))},e.createElement("table",{className:h(a,c(t,"am_table__table"))},e.createElement(x,{atom:l}),e.createElement(w,{atom:l}))),u?e.createElement(P,{atom:l}):null)}),(function(){return!0}));function I(e){var o;return{enabled:s(null!==(o=null==e?void 0:e.enabled)&&void 0!==o&&o),totalPages:s(null==e?void 0:e.totalPages),currentPage:s(null==e?void 0:e.currentPage),itemsPerPage:s(null==e?void 0:e.itemsPerPage)}}function H(e){var o,l;return{editable:s(null!==(o=null==e?void 0:e.editable)&&void 0!==o&&o),selection:s(null!==(l=null==e?void 0:e.selection)&&void 0!==l&&l),selected:s({}),onClick:null==e?void 0:e.onClick,onChange:null==e?void 0:e.onChange}}function M(e){return{onClick:null==e?void 0:e.onClick,onResize:null==e?void 0:e.onResize,width:s(null==e?void 0:e.width)}}function S(e){var o;return{selection:s(null!==(o=null==e?void 0:e.selection)&&void 0!==o&&o),selected:s({}),onSort:null==e?void 0:e.onSort,cell:M(null==e?void 0:e.cell)}}function j(e){var o,l,t,a,r,n;return{editable:s(null!==(o=null==e?void 0:e.editable)&&void 0!==o&&o),selected:s({}),selection:s(null!==(l=null==e?void 0:e.selection)&&void 0!==l&&l),onClick:null==e?void 0:e.onClick,classes:{root:s(null===(t=null==e?void 0:e.classes)||void 0===t?void 0:t.root)},overrideClasses:{root:s(null===(a=null==e?void 0:e.overrideClasses)||void 0===a?void 0:a.root)},indexing:{enabled:s(null===(r=null==e?void 0:e.indexing)||void 0===r?void 0:r.enabled),label:s(null===(n=null==e?void 0:e.indexing)||void 0===n?void 0:n.label)}}}function R(e){var o;return{defaultSortedColumn:s(null==e?void 0:e.defaultSortedColumn),defaultSortDirection:s(null!==(o=null==e?void 0:e.defaultSortDirection)&&void 0!==o?o:"asc")}}function O(e){var o,l,t,a,r,n,i,d,c,u,v,m,_,h,b,f,p,C,w,g,y,E,k,x,P,N,z,W,B,I,H,M,S,j,R,O,D,L,A,F,q,G,J,K,Q,T,U,V,X,Y,Z,$,ee,oe,le,te,ae,re;return{body:{classes:{root:s(null===(l=null===(o=null==e?void 0:e.body)||void 0===o?void 0:o.classes)||void 0===l?void 0:l.root)},overrideClasses:{root:s(null===(a=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.overrideClasses)||void 0===a?void 0:a.root)}},row:{classes:{root:s(null===(n=null===(r=null==e?void 0:e.row)||void 0===r?void 0:r.classes)||void 0===n?void 0:n.root)},overrideClasses:{root:s(null===(d=null===(i=null==e?void 0:e.row)||void 0===i?void 0:i.overrideClasses)||void 0===d?void 0:d.root)}},pagination:{classes:{root:s(null===(u=null===(c=null==e?void 0:e.pagination)||void 0===c?void 0:c.classes)||void 0===u?void 0:u.root)},overrideClasses:{root:s(null===(m=null===(v=null==e?void 0:e.pagination)||void 0===v?void 0:v.overrideClasses)||void 0===m?void 0:m.root)}},headerRow:{classes:{root:s(null===(h=null===(_=null==e?void 0:e.headerRow)||void 0===_?void 0:_.classes)||void 0===h?void 0:h.root)},overrideClasses:{root:s(null===(f=null===(b=null==e?void 0:e.headerRow)||void 0===b?void 0:b.overrideClasses)||void 0===f?void 0:f.root)}},headerCell:{classes:{root:s(null===(C=null===(p=null==e?void 0:e.headerCell)||void 0===p?void 0:p.classes)||void 0===C?void 0:C.root),resizeHandle:{root:s(null===(y=null===(g=null===(w=null==e?void 0:e.headerCell)||void 0===w?void 0:w.classes)||void 0===g?void 0:g.resizeHandle)||void 0===y?void 0:y.root)},content:{root:s(null===(x=null===(k=null===(E=null==e?void 0:e.headerCell)||void 0===E?void 0:E.classes)||void 0===k?void 0:k.content)||void 0===x?void 0:x.root)},sortBtn:{root:s(null===(z=null===(N=null===(P=null==e?void 0:e.headerCell)||void 0===P?void 0:P.classes)||void 0===N?void 0:N.sortBtn)||void 0===z?void 0:z.root)}},overrideClasses:{root:s(null===(B=null===(W=null==e?void 0:e.headerCell)||void 0===W?void 0:W.overrideClasses)||void 0===B?void 0:B.root),resizeHandle:{root:s(null===(M=null===(H=null===(I=null==e?void 0:e.headerCell)||void 0===I?void 0:I.overrideClasses)||void 0===H?void 0:H.resizeHandle)||void 0===M?void 0:M.root)},content:{root:s(null===(R=null===(j=null===(S=null==e?void 0:e.headerCell)||void 0===S?void 0:S.overrideClasses)||void 0===j?void 0:j.content)||void 0===R?void 0:R.root)},sortBtn:{root:s(null===(L=null===(D=null===(O=null==e?void 0:e.headerCell)||void 0===O?void 0:O.overrideClasses)||void 0===D?void 0:D.sortBtn)||void 0===L?void 0:L.root)}}},cell:{classes:{root:s(null===(F=null===(A=null==e?void 0:e.cell)||void 0===A?void 0:A.classes)||void 0===F?void 0:F.root)},overrideClasses:{root:s(null===(G=null===(q=null==e?void 0:e.cell)||void 0===q?void 0:q.overrideClasses)||void 0===G?void 0:G.root)}},header:{classes:{root:s(null===(K=null===(J=null==e?void 0:e.header)||void 0===J?void 0:J.classes)||void 0===K?void 0:K.root)},overrideClasses:{root:s(null===(T=null===(Q=null==e?void 0:e.header)||void 0===Q?void 0:Q.overrideClasses)||void 0===T?void 0:T.root)}},table:{classes:{root:s(null===(V=null===(U=null==e?void 0:e.table)||void 0===U?void 0:U.classes)||void 0===V?void 0:V.root)},overrideClasses:{root:s(null===(Y=null===(X=null==e?void 0:e.table)||void 0===X?void 0:X.overrideClasses)||void 0===Y?void 0:Y.root)}},container:{classes:{root:s(null===($=null===(Z=null==e?void 0:e.container)||void 0===Z?void 0:Z.classes)||void 0===$?void 0:$.root)},overrideClasses:{root:s(null===(oe=null===(ee=null==e?void 0:e.container)||void 0===ee?void 0:ee.overrideClasses)||void 0===oe?void 0:oe.root)}},wrapper:{classes:{root:s(null===(te=null===(le=null==e?void 0:e.wrapper)||void 0===le?void 0:le.classes)||void 0===te?void 0:te.root)},overrideClasses:{root:s(null===(re=null===(ae=null==e?void 0:e.wrapper)||void 0===ae?void 0:ae.overrideClasses)||void 0===re?void 0:re.root)}}}}function D(e){var o,l={};e.columns.forEach((function(e){return l[e.name]=e}));var t=i();return{atom:{columnsMap:s(l),idProperty:s(null!==(o=e.idProperty)&&void 0!==o?o:"id"),columns:s(e.columns.map((function(e){return s(e)}))),data:s(e.data),color:s(e.color),header:S(e.header),sort:R(e.sort),row:j(e.row),cell:H(e.cell),pagination:I(e.pagination),classes:O(e.classes)},store:t}}function L(o){var l=o.store,t=o.children;return e.createElement(e.Fragment,null,e.createElement(d,{store:l},t))}export{L as TableProvider,D as createAtoms,B as default};
